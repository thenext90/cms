---
---
import ISOToolsSectionClient from './ISOToolsSectionClient.jsx';
---

<ISOToolsSectionClient client:load />
      ai_summary: "El cumplimiento de la norma ISO 27001 es crucial para garantizar la seguridad de la información en las organizaciones.",
      category: "ISO_27001_Seguridad_Informacion",
      extracted_at: "2025-10-03T01:48:36.651Z"
    }
  ],
  statistics: {
    ai_success_rate: "100%"
  }
};

// Usar datos reales o fallback y filtrar la noticia específica
let displayData = isoData || fallbackData;

// Adaptar estructura del nuevo JSON (daily_news vs data)
if (displayData && displayData.daily_news) {
  // Nuevo formato: usar daily_news
  displayData.data = displayData.daily_news;
} else if (displayData && !displayData.data) {
  // Si no hay datos, usar fallback
  displayData = fallbackData;
}

// Función para formatear la fecha
function formatDate(dateString) {
  const date = new Date(dateString);
  return date.toLocaleDateString('es-ES', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}

// Función para mostrar texto completo (sin truncar)
function truncateText(text, maxLength = 999999) {
  // Mostrar texto completo sin límite
  return text;
}
---

<section class="pb-6 pt-12 bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- Titular con el mismo estilo que los años en NewsSection -->
    <div class="text-center mb-12">
      <h2 class="text-xl font-bold text-accent-800 bg-accent-50 inline-block px-6 py-3 rounded-full border-2 border-accent-200">
        Consejos y tendencias para ayudarte a mejorar tus sistemas de gestión
      </h2>
    </div>
    
    {displayData && displayData.data ? (
      <!-- Grid de artículos -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
        {displayData.data.map((article) => (
          <article class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden group">
            <!-- Header del artículo -->
            <div class="p-6 border-b border-gray-100">
              <div class="flex items-start justify-between mb-3">
                <div></div>
                <div class="flex items-center text-gray-500">
                  <Clock size="14" class="mr-1" />
                  <span class="text-xs">{formatDate(article.extracted_at)}</span>
                </div>
              </div>
              
              <h3 class="text-lg font-bold text-gray-800 leading-tight mb-3 group-hover:text-accent-800 transition-colors">
                {article.title}
              </h3>
            </div>

            <!-- Contenido del artículo -->
            <div class="p-6">
              <p class="text-gray-600 text-sm leading-relaxed mb-4">
                {truncateText(article.ai_summary)}
              </p>
              
              <div class="flex items-center justify-between">
                <div class="flex items-center text-xs text-gray-500">
                  <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full">
                    ✨ Resumen IA
                  </span>
                </div>
                <div class="flex items-center text-xs text-gray-400">
                  <span>Fuente: isotools.us</span>
                </div>
              </div>
            </div>
          </article>
        ))}
      </div>
    ) : (
      <!-- Estado de carga/error -->
      <div class="text-center py-12">
        <div class="bg-white rounded-xl shadow-lg p-8 max-w-md mx-auto">
          <AlertCircle size="48" class="text-yellow-500 mx-auto mb-4" />
          <h3 class="text-lg font-semibold text-gray-800 mb-2">Contenido no disponible</h3>
          <p class="text-gray-600">No se pudieron cargar los artículos en este momento.</p>
        </div>
      </div>
    )}
  </div>
</section>