name: 🔄 Auto-Update ISO News Data

on:
  schedule:
    # Ejecutar diariamente a las 6:00 AM UTC (2:00 AM Chile)
    - cron: '0 6 * * *'
  
  # Permitir ejecución manual
  workflow_dispatch:
    inputs:
      days_back:
        description: 'Días hacia atrás para buscar'
        required: false
        default: '45'
        type: string

env:
  NODE_VERSION: '18'
  PYTHON_VERSION: '3.11'

jobs:
  update-iso-news:
    name: 📊 Actualizar datos ISO Chile
    runs-on: ubuntu-latest
    timeout-minutes: 30
    
    steps:
    - name: 📥 Checkout repository
        python -m pip install --upgrade pip
      run: |
      name: 🔄 Auto-Update ISO News Data

      on:
        schedule:
          - cron: '0 6 * * *' # Ejecutar diariamente a las 6:00 AM UTC
        workflow_dispatch:

      env:
        PYTHON_VERSION: '3.11'

      jobs:
        update-iso-news:
          name: 📊 Actualizar datos ISO Chile
          runs-on: ubuntu-latest
          timeout-minutes: 30
    
          steps:
            - name: 📥 Checkout repository
              uses: actions/checkout@v4
              with:
                token: ${{ secrets.GITHUB_TOKEN }}
                fetch-depth: 0
            - name: 🐍 Setup Python
              uses: actions/setup-python@v4
              with:
                python-version: ${{ env.PYTHON_VERSION }}
                cache: 'pip'
            - name: 📦 Install Python dependencies
              run: |
                python -m pip install --upgrade pip
                pip install -r scripts/requirements.txt
            - name: � Ejecutar scraper de noticias ISO
              run: |
                python scripts/iso_news_scraper_real.py
                python scripts/iso_news_scraper_enhanced.py
                python scripts/iso_news_scraper_newsapi.py
            - name: 📝 Commit y push si hay cambios
              run: |
                git config --global user.name 'github-actions[bot]'
                git config --global user.email 'github-actions[bot]@users.noreply.github.com'
                git add src/data/*.json || true
                git commit -m 'chore: auto-update ISO news data' || echo 'No changes to commit'
                git push || echo 'No changes to push'
    - name: 📤 Commit and push changes
